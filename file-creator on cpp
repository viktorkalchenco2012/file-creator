#include <iostream>
#include <string>
#include <fstream>
#include <windows.h>
#include <Lmcons.h>
#include <cstdlib>
#include <shellapi.h>
using namespace std;

int main() {

	char username[UNLEN + 1];
	DWORD username_len = UNLEN + 1;

	if (GetUserNameA(username, &username_len)) {
		std::cout << "Username: " << username << std::endl;
	}

	std::string filePath = "C:\\Users\\" + std::string(username) + "\\Desktop\\not_a_virus.txt";
	std::cout << filePath;

	
	std::ofstream file(filePath, ios_base::out);
	if (file.is_open())
	{
		file.close();
	}
	else
	{
		return 1;
	}
	ifstream(filePath, ios_base::in);
	file.open(filePath);
	if (file.is_open()) {
		file << "hello" << endl << "world" << endl;
		file.close();
	}
	else
	{
		return 200;
	}
	std::string appToOpen;

#ifdef _WIN32
	appToOpen = filePath;
#elif __APPLE__
	appToOpen = "open /Applications/Calculator.app";
#elif __linux__
	appToOpen = "xdg-open https://www.google.com";
#else
	std::cerr << "Unsupported platform" << std::endl;
	return 1;
#endif
	int result = std::system(appToOpen.c_str());

	if (result == 0) {
		std::cout << "Application launched successfully." << std::endl;
	}
	else {
		std::cerr << "Failed to launch application. Error code: " << result << std::endl;
	}

	return 0;
}
